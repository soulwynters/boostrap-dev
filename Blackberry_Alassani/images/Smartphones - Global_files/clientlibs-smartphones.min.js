"use strict";
var blackberrycom=blackberrycom?blackberrycom:{};
blackberrycom.smartphones=blackberrycom.smartphones?blackberrycom.smartphones:{};
blackberrycom.smartphones.buyHero={init:function(){var a=this,b=$(".f-smartphones-buyHero");
if(b.length>0){blackberrycom.getProductData("id",function(){b.find(".noCarriers").addClass("hidden");
b.find(".loading").show();
b.find(".clone").remove();
var q=b.children(".buyContent").clone().addClass("clone"),g=q.children(".models"),j=q.children(".colors"),m=q.children(".tariff"),s=q.children(".carriers"),k=q.find(".carriers .featured"),r=q.find(".carriers .other"),f=q.find(".carriers .locked"),h=q.find(".carriers .unlocked"),d=q.find(".carriers .static");
var c=blackberrycom.smartphones.productData;
var n=false;
if(blackberrycom.smartphones.currentProducts&&c){for(var l=0;
l<blackberrycom.smartphones.currentProducts.length;
l++){var o=blackberrycom.smartphones.currentProducts[l];
for(var e=0;
e<c.length;
e++){var p=c[e];
if(o===p.productId){n=true;
a.populateCarriersForProduct(q,p);
a.populateColorsForProduct(q,p);
a.populateModelsForProduct(q,p)
}}}m.find("li").on("click",function(){a.filter(q,$(this),$(".carriers .locked .filterable"))
});
j.find("li").on("click",function(){m.find("li").removeClass("active");
a.filter(q,$(this));
blackberrycom.smartphones.colorSwitcher.switchImages($(this))
});
g.find("li").on("click",function(){m.find("li").removeClass("active");
a.filter(q,$(this));
var t=blackberrycom.smartphones.activeProduct;
var i=$(this).attr("data-model");
blackberrycom.smartphones.modelSwitcher.switchModels(t,i)
}).find("img").on("error",function(){$(this).hide();
$(this).siblings(".swatch").show()
});
q.find(".toggle-featured-text").on("click",function(i){i.preventDefault();
q.find(".featured-carrier-text").toggle()
});
if(q.find(".carrier.clone").length===0){b.find(".noCarriers").removeClass("hidden")
}if(q.find('.carrier[data-tariff="payg"]').length>0){m.removeClass("hidden")
}if(g.find("li.clone").length<2){g.find("li.clone:first").addClass("active")
}if(j.find("li.clone").length<2){j.find("li.clone:first").addClass("active")
}if(q.find(".active").length>0){a.filter(q)
}q.find(".filter-section:not(.hidden):first").removeClass("disabled");
q.appendTo(b)
}else{b.find(".noCarriers").removeClass("hidden")
}b.find(".loading").hide();
$(document).foundation("equalizer","reflow")
})
}},getColorsForProduct:function(b){var a=b.colors.sort(function(d,c){if(d.label<c.label){return -1
}else{return 1
}});
return a
},populateColorsForProduct:function(h,g){var d=h.children(".colors");
var i=h.children(".carriers");
var a=this.getColorsForProduct(g);
for(var b=0;
b<a.length;
b++){var f=a[b];
if(d.find('li[data-color="'+f.label+'"][data-model="'+g.productId+'"]').length===0&&i.find('[data-color="'+f.label+'"]').length>0){if(d.find('li[data-color="'+f.label+'"]').length===0){var e=d.find("li:not(.clone)").clone().addClass("clone");
e.addClass(f.label).attr({"data-model":g.productId,"data-color":f.label}).text(f.label);
d.find("ul").append(e);
d.removeClass("hidden")
}else{var c=d.find('li[data-color="'+f.label+'"]').attr("data-model");
d.find('li[data-color="'+f.label+'"]').attr("data-model",g.productId+"|"+c)
}}}},populateModelsForProduct:function(a,g){var c=a.children(".models");
var f=a.children(".colors");
var d=a.children(".carriers");
var b=this.getColorsForProduct(g);
if(blackberrycom.smartphones.currentProducts.length>1&&c.find('li.clone[data-modelName="'+g.label+'"]').length===0&&d.find('[data-model="'+g.productId+'"]').length>0){var e=c.find("li:not(.clone)").clone().addClass("clone");
e.find("img").attr("src",g.imagePath+"/model-icon.png");
e.find(".swatch").addClass(b[0].label);
e.attr("data-model",g.productId);
e.attr("data-modelName",g.label);
e.find(".model-name").html("<strong>"+g.make+"</strong> "+g.label);
c.find("ul").append(e);
c.removeClass("hidden")
}else{f.find("li.clone").removeClass("disabled")
}if(c.find("li.clone").length<2){c.addClass("hidden");
f.find("li.clone").removeClass("disabled")
}},populateCarriersForProduct:function(m,q){var l=m.children(".carriers"),e=m.find(".carriers .featured"),i=m.find(".carriers .preregister"),s=m.find(".carriers .preorder"),v=m.find(".carriers .other"),r=m.find(".carriers .locked"),f=m.find(".carriers .unlocked"),a=m.find(".carriers .static");
var n=q.retailers;
for(var p=0;
p<n.length;
p++){var h=n[p];
var b=h.monthly?"monthly":"payg";
if(h.country===blackberrycom.location.country){if((blackberrycom.location.country==="ca"&&h.language===blackberrycom.location.language)||blackberrycom.location.country!=="ca"){for(var o=0;
o<h.purchaseOptions.length;
o++){var c=h.purchaseOptions[o];
var g='<li data-model="'+q.productId+'" data-color="'+c.color.label+'" ',t="filterable carrier disabled clone";
var d="";
if(h.logoPath){d="style=\"background-image:url('"+h.logoPath+"');\" "
}else{t+="no-logo "
}g+='data-tariff="'+b+'" data-color="'+c.color.label+'" class="'+t+'""><a class="carrier-sku" '+d+' href="'+c.buyStateUrl+'" target="_blank">'+h.label+"</a></li>";
if(typeof c.buyStateUrl==="undefined"||c.buyStateUrl===""){a.removeClass("hidden");
a.find("ul").append(g)
}else{if(h.label.indexOf("ShopBlackBerry")>-1){var u=e.find(".f-core-link a:not(.clone)").clone().addClass("clone");
u.attr({"data-tariff":b,"data-model":q.productId,"data-color":c.color.label,href:c.buyStateUrl,title:h.label});
if(c.buyState==="purchase"){u.text(Granite.I18n.get("Buy now from BlackBerry"))
}else{if(c.buyState==="preorder"){u.text(Granite.I18n.get("Pre-order now from BlackBerry"))
}else{if(c.buyState==="preregister"){u.text(Granite.I18n.get("Register for updates from BlackBerry"))
}}}e.find(".f-core-link").append(u);
e.removeClass("hidden")
}else{if(c.buyState==="preregister"){i.removeClass("hidden").find("ul").append(g)
}else{if(c.buyState==="preorder"){s.removeClass("hidden").find("ul").append(g)
}else{v.removeClass("hidden");
if(!h.unlocked){r.removeClass("hidden").find("ul").append(g)
}else{f.removeClass("hidden").find("ul").append(g)
}}}}}}}l.removeClass("hidden")
}}},filter:function(j,l,f){var c=this;
var d=j.find(".active").parents(".filter-section").nextAll(":not(.hidden)").find(".filterable");
if(l){d=l.parents(".filter-section").nextAll(":not(.hidden)").find(".filterable")
}if(f){d=f
}d.addClass("disabled").removeClass("active");
if(l){l.siblings().removeClass("active");
l.addClass("active")
}var a="";
j.find(".active").each(function(){var o=$(this).data();
for(var n in o){if(a.indexOf("data-"+n)==-1){if(n==="model"||n==="color"||n==="tariff"){if(n==="model"){if($(this).parents(".models").length>0){a+="[data-"+n+'*="'+o[n]+'"]'
}}else{a+="[data-"+n+'="'+o[n]+'"]'
}}}}});
var i=d.filter(a);
i.removeClass("disabled");
var m=j.find(".carriers"),h=j.find(".carriers .featured"),k=j.find(".carriers .other"),e=j.find(".carriers .locked"),g=j.find(".carriers .unlocked"),b=j.find(".carriers .static");
c.toggleContainer(h);
c.toggleContainer(k);
c.toggleContainer(e);
c.toggleContainer(g);
c.toggleContainer(b);
if(h.css("display")==="block"){m.addClass("has-featured")
}else{m.removeClass("has-featured")
}j.find(".filter-section:not(:has(.active))").addClass("disabled");
if(l){l.parents(".filter-section").nextAll(":not(.hidden)").first().removeClass("disabled")
}else{j.find(".active").parents(".filter-section").nextAll(":not(.hidden)").first().removeClass("disabled")
}},toggleContainer:function(a){if(a.find(".carrier:not(.disabled)").length>0){a.show()
}else{a.hide()
}}};
var blackberrycom=blackberrycom?blackberrycom:{};
blackberrycom.smartphones=blackberrycom.smartphones?blackberrycom.smartphones:{};
blackberrycom.smartphones.colorSwitcher={init:function(b){var e=blackberrycom.smartphones.productData,c=this,d=$(".f-smartphones-colorSwitcher"),a=$('img[src*="/device"]');
if(d.length>0){d.find(".clone").remove();
a.each(function(){var g=$(this).attr("src"),f=g.replace(/(.+?\..+?)(\/|$).*/g,"$1"),h="/jcr:content/renditions/original";
$(this).attr("src",f+h)
});
$("[data-color-switch]").removeAttr("data-color-switch");
d.each(function(){var f=$(this);
var m=blackberrycom.smartphones.activeProduct?blackberrycom.smartphones.activeProduct:f.closest("[data-model]").attr("data-model");
if(m){var l=c.getProductById(m);
var k=c.getColorsForProduct(l);
for(var g=0;
g<k.length;
g++){var h=k[g];
if(f.find('[data-color="'+h.label+'"]').length===0&&c.isColorAvailable(h.label,l)){var i=f.find("li:not(.clone)").clone().addClass("clone");
i.attr({"data-color":h.label,title:h.label,style:"background-color:"+h.hex+";"}).text(h.label).addClass(h.label);
f.children("ul").append(i)
}}f.fadeIn();
if(f.find("[data-color]").length<2&&typeof blackberrycom.smartphones.activeProduct!=="undefined"){f.hide()
}}});
if(typeof b==="undefined"||!b){d.find("li").on("click.colorSwitcher",blackberrycom.smartphones.colorSwitcher.click)
}else{d.addClass("unclickable")
}}},isColorAvailable:function(a,h){var g=false;
for(var e=0;
e<h.retailers.length;
e++){var d=h.retailers[e];
var b=d.purchaseOptions;
if(d.country===blackberrycom.location.country){for(var c=0;
c<b.length;
c++){var f=b[c];
if(f.color.label===a){g=true
}}}}return g
},getProductById:function(b){for(var a=0;
a<blackberrycom.smartphones.productData.length;
a++){var c=blackberrycom.smartphones.productData[a];
if(b===c.productId||b.indexOf(c.productId)>-1){return c
}}},getColorsForProduct:function(b){var a=b.colors.sort(function(d,c){if(d.label<c.label){return -1
}else{return 1
}});
return a
},switchImages:function(b){var a=$('img[src*="/device"]'),c=b.attr("data-color");
a.each(function(){var f=$(this).attr("src"),d=f.replace(/.+?(\..+?)(\/|$).*/g,"$1"),e=f.replace(/(.+?\..+?)(\/|$).*/g,"$1"),g="/jcr:content/renditions/original",h="/jcr:content/renditions/color."+c+d;
if(b.is(b.parents("ul").children("li.clone:visible:first"))){$(this).attr({src:e+g})
}else{$(this).attr({src:e+h})
}})
},click:function(){var b=$(this),d=$(".f-smartphones-colorSwitcher"),a=$('img[src*="/device"]');
var e="";
e=$(this).attr("data-color");
blackberrycom.smartphones.activeColor=e;
if(!b.hasClass("disabled")&&!b.hasClass("active")){blackberrycom.smartphones.colorSwitcher.switchImages(b);
if(b.parent().attr("data-change-bg")=="true"){var c=$(this).parents(".f-core-pageSection").find("> div");
c.addClass("color-switched");
c.removeClass(function(f,g){return(g.match(/(^|\s)bg-color-(.+)\S+/g)||[]).join(" ")
});
c.attr("data-color-switch",e)
}d.find("li[data-color="+e+"]").siblings().removeClass("active");
d.find("li[data-color="+e+"]").addClass("active")
}}};
var blackberrycom=blackberrycom?blackberrycom:{};
blackberrycom.smartphones=blackberrycom.smartphones?blackberrycom.smartphones:{};
blackberrycom.smartphones.compare={init:function(){var h=$(".f-smartphones-compare");
if(h.length>0){var g=this,p=h.find(".compare-devices"),f=p.children(".devices"),n=p.children(".specs"),s=p.children(".buy"),c=$(".f-smartphones-compare-modal"),t=typeof p.attr("data-devicePriority")!=="undefined"?p.attr("data-devicePriority").split(","):[];
h.find(".clone").remove();
f.find(".device-column").addClass("empty");
for(var i=0;
i<t.length;
i++){var e=t[i];
var q=g.getProductById(e);
if(q){if(blackberrycom.smartphones.compare.cart.length==0){blackberrycom.smartphones.compare.add(q.productId)
}var b=$(".f-smartphones-compare-modal").find("[data-productLine]").filter(function(){return $(this).attr("data-productLine")===escape(q.productLine)
});
if(b.length>0){var k=b;
if(k.attr("data-compare").indexOf(q.productId)===-1){k.attr("data-compare",k.attr("data-compare")+"|"+q.productId)
}}else{var r=c.find("li:not(.clone)").clone().addClass("clone");
if(blackberrycom.smartphones.compare.getCartIndex(q.productId)>-1){r.addClass("disabled")
}r.attr({"data-compare":q.productId,"data-productLine":escape(q.productLine)});
r.find("img").attr("src",r.find("img").attr("src").replace("{0}",q.imagePath));
r.find(".make").text(q.make);
r.find(".model").text(q.productLine);
c.find("ul").append(r)
}}}for(var o=0;
o<blackberrycom.smartphones.compare.cart.length;
o++){var d=blackberrycom.smartphones.compare.cart[o];
var q=g.getProductById(d);
if(q){if(f.find('[data-productLine="'+escape(q.productLine)+'"]').length===0){var a=f.children(".device-column").eq(o);
var l=a.find(".inner").clone().addClass("clone");
l.attr({"data-compare":q.productId,"data-productLine":escape(q.productLine)});
l.find("img").attr("src",q.imagePath+"/device-proportional.png/jcr:content/renditions/cq5dam.thumbnail.319.319.png");
l.find(".make").text(q.make);
l.find(".model").text(q.productLine);
l.find(".f-core-link a").text(q.farthestBuyState).attr("href",q.pagePath+"/buy.html");
a.removeClass("empty").append(l);
n.find(".f-smartphones-specPageSection").each(function(){var j=$(this),v=j.find(".row.inner"),u=j.find(".specs-container:not(.clone) > *");
j.addClass("column");
u.each(function(){var z=$(this),y=z.find("[data-spec]").attr("data-spec"),x=z.clone();
console.log(z,y);
x.attr({"data-model":q.productId}).addClass("column medium-3 small-3 end clone");
if(x.find("img").length>0){y="image";
x.find("img").attr("src",q.imagePath+"/device-proportional-back.png/jcr:content/renditions/cq5dam.thumbnail.319.319.png")
}if(x.hasClass("f-smartphones-colorSwitcher")){y="colorSwitcher"
}var w=$('<div class="spec-row row" data-spec="'+y+'"></div>');
if(v.find('.spec-row[data-spec="'+y+'"]').length>0){w=v.find('.spec-row[data-spec="'+y+'"]')
}if(y){w.append(x);
v.append(w)
}})
});
var m=s.find(".f-smartphones-specPageSection .column:not(.clone)").clone().addClass("clone");
m.find("a").text(q.farthestBuyState).attr("href",q.pagePath+"/buy.html");
s.find(".row").append(m)
}}}h.on("scroll",function(){$(this).find(".f-smartphones-specPageSection h2").css({"margin-left":$(this).scrollLeft()})
});
h.find(".actions .remove-device").unbind().on("click",function(u){u.preventDefault();
var j=$(this).parents("[data-compare]");
blackberrycom.smartphones.compare.remove(j.attr("data-compare"));
blackberrycom.smartphones.compare.init()
});
h.find(".add-device").unbind().on("click",function(j){j.preventDefault();
c.foundation("reveal","open")
});
h.find(".actions .switch-device").unbind().on("click",function(j){j.preventDefault();
f.children().removeClass("active");
$(this).parents("[data-compare]").addClass("active");
c.foundation("reveal","open")
});
c.find("li:not(.disabled)").unbind().on("click",function(u){u.preventDefault();
var v=$(this).attr("data-compare"),j=f.find(".active");
if(j.length>0){blackberrycom.smartphones.compare.add(v,j.index())
}else{blackberrycom.smartphones.compare.add(v)
}f.children().removeClass("active");
c.foundation("reveal","close");
blackberrycom.smartphones.compare.init()
});
blackberrycom.smartphones.spec.init();
blackberrycom.smartphones.colorSwitcher.init(true);
h.find(".loading").fadeOut();
p.fadeIn()
}},getProductById:function(b){for(var a=0;
a<blackberrycom.smartphones.productData.length;
a++){var c=blackberrycom.smartphones.productData[a];
if(b===c.productId||b.indexOf(c.productId)>-1){return c
}}},cart:typeof $.cookie("compareData")=="undefined"||$.cookie("compareData").length==0?[]:$.cookie("compareData").split(","),getCartIndex:function(c){var a=-1;
for(var b=0;
b<blackberrycom.smartphones.compare.cart.length;
b++){var d=blackberrycom.smartphones.compare.cart[b];
if(d.indexOf(c)>-1){a=b
}}return a
},add:function(b,a){if(typeof a!=="undefined"){blackberrycom.smartphones.compare.cart[a]=b
}else{if(blackberrycom.smartphones.compare.getCartIndex(b)>-1){console.log("Already in compare cart!");
return false
}else{if(blackberrycom.smartphones.compare.cart.length>3){console.log("Too many devices!");
return false
}else{blackberrycom.smartphones.compare.cart.push(b)
}}}$.cookie("compareData",blackberrycom.smartphones.compare.cart,{path:"/"})
},remove:function(c,a){if(typeof c!="undefined"){if(typeof a!="undefined"){blackberrycom.smartphones.compare.cart.splice(a,1)
}else{if(blackberrycom.smartphones.compare.getCartIndex(c)>-1){var b=blackberrycom.smartphones.compare.getCartIndex(c);
blackberrycom.smartphones.compare.cart.splice(b,1)
}}$.cookie("compareData",blackberrycom.smartphones.compare.cart,{path:"/"})
}else{blackberrycom.smartphones.compare.cart=[];
$.cookie("compareData","",{path:"/"})
}}};
var blackberrycom=blackberrycom?blackberrycom:{};
blackberrycom.smartphones=blackberrycom.smartphones?blackberrycom.smartphones:{};
blackberrycom.smartphones.modelSwitcher={init:function(){var c=this,b=$(".f-smartphones-modelSwitcher");
if(b.length>0){var a=c.getProductById(blackberrycom.smartphones.activeProduct);
if(blackberrycom.smartphones.currentProducts.length>1){blackberrycom.getProductData("id",function(){var j=blackberrycom.smartphones.productData;
for(var e=0;
e<blackberrycom.smartphones.currentProducts.length;
e++){var f=blackberrycom.smartphones.currentProducts[e];
var h=c.getProductById(f);
if(h){if(b.find('[data-modelName="'+h.label+'"]').length===0){var g=b.eq(0).find("li:not(.clone)").clone().addClass("clone");
var d=c.getColorsForProduct(h);
g.find("img").attr("src",h.imagePath+"/model-icon.png");
g.find(".swatch").addClass(d[0].label);
g.attr("data-model",h.productId);
g.attr("data-modelName",h.label);
g.find(".model-name").html("<strong>"+h.make+"</strong> "+h.label);
b.find("ul").append(g)
}}}b.find("li:not(.clone)").remove();
if(b.find("li").length>1){b.fadeIn();
$(document).foundation("equalizer","reflow")
}})
}else{b.hide()
}b.find("img").one("error",function(){$(this).hide();
$(this).siblings(".swatch").show()
});
b.find("li").on("click",function(){if(!$(this).hasClass("disabled")&&!$(this).hasClass("active")){var e=blackberrycom.smartphones.activeProduct;
var d=$(this).attr("data-model");
c.switchModels(e,d)
}})
}},switchModels:function(g,c){var f=this;
var e=$(".f-smartphones-modelSwitcher");
var a=f.getProductById(g);
var d=f.getProductById(c);
blackberrycom.smartphones.activeProduct=c;
var b=$(".f-core-main .f-core-image img.switchable");
b.each(function(){var k=$(this).attr("src");
if(k){var i=k.replace(/(.+?\..+?)((\/|$).*)/g,"$1"),m=i.replace(a.imagePath+"/",d.imagePath+"/"),l="/jcr:content/renditions/original",h=k.replace(/(.+?\..+?)((\/|$).*)/g,"$2"),j="";
if(k.indexOf("/color.")>-1){j=m+l
}else{j=m+h
}$(this).attr("src",j)
}});
e.find("li[data-model="+c+"]").siblings().removeClass("active");
e.find("li[data-model="+c+"]").addClass("active");
blackberrycom.smartphones.spec.init();
blackberrycom.smartphones.colorSwitcher.init()
},getProductById:function(b){for(var a=0;
a<blackberrycom.smartphones.productData.length;
a++){var c=blackberrycom.smartphones.productData[a];
if(b===c.productId||b.indexOf(c.productId)>-1){return c
}}},getColorsForProduct:function(b){var a=b.colors.sort(function(d,c){if(d.label<c.label){return -1
}else{return 1
}});
return a
}};
var blackberrycom=blackberrycom?blackberrycom:{};
blackberrycom.smartphones=blackberrycom.smartphones?blackberrycom.smartphones:{};
blackberrycom.smartphones.landing={init:function(){var a=$(".f-smartphones-landing");
var b=a.find(".f-smartphones-compareBar");
if(a.length>0){a.find(".devices [style]").removeAttr("style");
a.find(".clone").remove();
blackberrycom.getProductData("country",function(){var c=blackberrycom.smartphones.productData;
var m=a.find("[data-devicePriority]").attr("data-devicePriority").split(",");
for(var e=0;
e<m.length;
e++){var f=m[e];
for(var g=0;
g<c.length;
g++){var o=c[g];
if(f===o.productId){if(blackberrycom.smartphones.compare.getCartIndex(o.productId)>-1){blackberrycom.smartphones.landing.compareBar.add(o.productId)
}var p=a.find(".model").filter(function(){return $(this).text()===o.productLine
});
if(p.length>0){var h=p.parents("li");
h.attr("data-compare",h.attr("data-compare")+"|"+o.productId);
if(o.colors){for(var d=0;
d<o.colors.length;
d++){var n=o.colors[d];
if(h.find('[data-color="'+n.label+'"]').length===0){h.find(".colors").append('<li data-color="'+n.label+'" class="clone '+n.label+'" title="'+n.label+'" style="background-color:'+n.hex+';">'+n.label+"</li>")
}}}}else{var l=a.find("li.device:not(.clone)").clone().addClass("clone");
l.attr("data-compare",o.productId);
l.find("a.block-link").attr("href",location.pathname.replace(/^(.*)\/.*?$/g,"$1")+o.pagePath+".html");
l.find("img").attr("src",l.find("img").attr("src").replace("{0}",o.imagePath));
l.find(".make").text(o.make);
l.find(".model").text(o.productLine);
if(blackberrycom.smartphones.compare.getCartIndex(o.productId)>-1){l.find(".compare").addClass("active")
}if(o.colors){for(var d=0;
d<o.colors.length;
d++){var n=o.colors[d];
l.find(".colors").append('<li data-color="'+n.label+'" class="clone '+n.label+'" title="'+n.label+'" style="background-color:'+n.hex+';">'+n.label+"</li>")
}}a.find("ul.device-grid").append(l)
}}}}if(a.find(".device-grid").children(".clone").length===0){a.find(".no-devices-available").show()
}else{a.find(".no-devices-available").hide()
}blackberrycom.smartphones.landing.compareBar.getStatus();
a.find(".loading").hide();
a.find(".device-grid").fadeIn()
});
a.on("click",".compare",function(d){d.preventDefault();
var c=$(this).parents("[data-compare]").attr("data-compare");
if($(this).hasClass("active")){blackberrycom.smartphones.compare.remove(c);
blackberrycom.smartphones.landing.compareBar.remove(c)
}else{if(blackberrycom.smartphones.compare.cart.length<4){blackberrycom.smartphones.landing.compareBar.add(c);
blackberrycom.smartphones.compare.add(c)
}else{$(".f-smartphones-compareBar .warning").show().delay(6000).fadeOut("fast")
}}blackberrycom.smartphones.landing.compareBar.getStatus()
});
b.on("click",".compare-clear",function(c){c.preventDefault();
blackberrycom.smartphones.compare.remove();
blackberrycom.smartphones.landing.compareBar.remove();
blackberrycom.smartphones.landing.compareBar.getStatus()
});
b.on("click","li[data-compare] .remove",function(f){f.preventDefault();
var d=$(this).parents("[data-compare]");
var c=d.attr("data-compare");
blackberrycom.smartphones.compare.remove(c);
blackberrycom.smartphones.landing.compareBar.remove(c);
blackberrycom.smartphones.landing.compareBar.getStatus()
})
}},compareBar:{getStatus:function(){var a=$(".f-smartphones-landing");
var b=a.find(".f-smartphones-compareBar");
if(blackberrycom.smartphones.compare.cart.length>1){b.find(".button").removeClass("disabled")
}else{b.find(".button").addClass("disabled")
}},add:function(e){var a=$(".f-smartphones-landing");
var f=a.find(".f-smartphones-compareBar");
for(var c=0;
c<blackberrycom.smartphones.productData.length;
c++){var g=blackberrycom.smartphones.productData[c];
var b=escape(g.productLine);
if(e.indexOf(g.productId)>-1&&f.find('li[data-productLine="'+b+'"]').length===0){var d=f.find("li:not(.clone)").clone().addClass("clone");
d.attr("data-compare",e);
d.attr("data-productLine",b);
d.find("img").attr({src:d.find("img").attr("src").replace("{0}",g.imagePath),title:g.make+" "+g.productLine,alt:g.make+" "+g.productLine});
a.find('[data-compare*="'+g.productId+'"] .compare').addClass("active");
f.find("ul").append(d);
f.addClass("active")
}}},remove:function(b){var a=$(".f-smartphones-landing");
var c=a.find(".f-smartphones-compareBar");
if(b){a.find('[data-compare*="'+b+'"] .compare').removeClass("active");
c.find('li[data-compare*="'+b+'"]').remove();
if(blackberrycom.smartphones.compare.cart.length===0){c.removeClass("active")
}}else{a.find("[data-compare] .compare").removeClass("active");
c.find("li[data-compare]").remove();
c.removeClass("active")
}}}};
var blackberrycom=blackberrycom?blackberrycom:{};
blackberrycom.smartphones=blackberrycom.smartphones?blackberrycom.smartphones:{};
blackberrycom.smartphones.pinnedDevice={controller:new ScrollMagic(),init:function(){var a=$("[data-deviceScreen]"),e=$(".f-smartphones-pinnedDevice").eq(0),f=e.find(".screenContainer");
if(e.length>0){if($(window).width()>640){for(var c=0;
c<a.length;
c++){var d=a.eq(c);
f.prepend('<div class="screen" data-deviceScreen="'+d.attr("data-deviceScreen")+'" data-interchange="'+d.attr("data-deviceScreen")+'"></div>')
}$(document).foundation("interchange","reflow");
var b=20;
blackberrycom.smartphones.pinnedDevice.setDevice();
var g=f.height();
a.each(function(h){var i=$(this);
if(h!=a.length-1){new ScrollScene({triggerElement:i.parents(".f-core-pageSection").next(),triggerHook:"onEnter",offset:$(window).height()-(($(window).height()-e.height())/2+f.height()+f.position().top)-b,duration:g}).setTween(TweenMax.to(e.find('.screen[data-deviceScreen="'+i.attr("data-deviceScreen")+'"]'),0.3,{top:-g+"px","background-position":"0 "+g+"px",ease:Linear.easeNone})).addTo(blackberrycom.smartphones.pinnedDevice.controller)
}})
}else{a=$(".f-core-pageSection > div:has(.f-smartphones-pinnedDevice), .f-core-pageSection > div[data-deviceScreen], .f-core-pageSection > div[data-hideDevice]");
a.each(function(l){var o=$(this);
var j=o.attr("data-deviceScreen");
var m=e.clone();
m.addClass("clone");
if(m.find(".center").length==0){m.find("img").wrap('<div class="center"></div>')
}var i=m.find(".screenContainer");
var k=(parseInt(i.css("left"))/i.parents(".inner").width())*100+"%",n=(parseInt(i.css("top"))/585)*100+"%",h=(i.width()/i.parents(".inner").width())*100+"%";
i.css({top:n,left:k,height:"100%",width:h,background:"url("+j+") 0 0 no-repeat transparent","background-size":"contain"});
i=i.detach();
m.find(".center").append(i);
if(l%2==0){m.addClass("even")
}if(o.find(".f-smartphones-pinnedDevice").length>0){o.find(".f-smartphones-pinnedDevice").after(m)
}else{o.children("div").append(m)
}})
}$(window).on("resize",function(h){if($(window).width()<640&&blackberrycom.smartphones.pinnedDevice.controller.enabled()){blackberrycom.smartphones.pinnedDevice.controller.enabled(false)
}else{if(!blackberrycom.smartphones.pinnedDevice.controller.enabled()){blackberrycom.smartphones.pinnedDevice.controller.enabled(true)
}}})
}},setDevice:function(){var d=$(".f-smartphones-pinnedDevice").eq(0),b=$("[data-hideDevice]").parents(".f-core-pageSection");
var a=20;
var c=new ScrollScene({triggerElement:d,offset:(d.outerHeight()/2)-a,duration:b.length>0?b.offset().top-d.parents(".f-core-pageSection").offset().top-(d.offset().top-d.parents(".f-core-pageSection").offset().top)+parseInt(b.find(".f-core-pageSection-inner").css("padding-top")):0}).setPin(d);
blackberrycom.smartphones.pinnedDevice.controller.removeScene(c);
blackberrycom.smartphones.pinnedDevice.controller.addScene(c)
},refresh:function(){blackberrycom.smartphones.pinnedDevice.setDevice()
}};
var blackberrycom=blackberrycom?blackberrycom:{};
blackberrycom.smartphones=blackberrycom.smartphones?blackberrycom.smartphones:{};
blackberrycom.smartphones.spec={init:function(){var a=this,b=$(".f-smartphones-spec");
blackberrycom.getProductData("id",function(){b.each(function(){var l=$(this),h=l.find("[data-spec]").attr("data-spec"),e=l.find("p.spec:not(.clone)").clone().addClass("clone");
l.find(".clone").remove();
var i=blackberrycom.smartphones.activeProduct?blackberrycom.smartphones.activeProduct:l.closest("[data-model]").attr("data-model");
if(i){var p=a.getProductById(i);
if(h){var r=h.split(",");
for(var k=0;
k<r.length;
k++){var q=r[k];
var c=p.specification[q],g="",m="";
if(c){if(typeof c==="string"){g=c
}else{if(typeof c==="number"){g=a.convertDecimalsToCommas(c)
}else{if(typeof c==="boolean"){g='<p class="checkmark">Yes</p>'
}else{if(typeof c==="object"){if($.isArray(c)){c=c.sort();
for(var n=0;
n<c.length;
n++){var o=c[n];
if(typeof o==="object"){if(q==="supportedWifiProtocols"){g+="<p>"+o.version+" "+o.frequency+o.unit+"</p>"
}else{g=a.convertDecimalsToCommas(o.value);
m=o.unit
}}else{g+=o;
if(n<c.length-1){g+=", "
}}}}else{var d,f;
g=a.convertDecimalsToCommas(c.value);
m=c.unit;
if(typeof c.value==="number"&&c.unit==="mm"||c.unit==="g"){if(c.unit==="mm"){d=Math.round(100*(c.value/25.4))/100;
f="in";
if(typeof Granite!=="undefined"){f=Granite.I18n.get("in")
}}else{if(c.unit==="g"){d=Math.round(100*(c.value/28.3495))/100;
f="oz";
if(typeof Granite!=="undefined"){f=Granite.I18n.get("oz")
}}}g=a.convertDecimalsToCommas(c.value)+" "+c.unit+" / "+a.convertDecimalsToCommas(d)+" "+f
}else{if(q.indexOf("StandbyTime")>-1){g=Math.round(100*(c.value/24))/100;
m="d"
}}}}}}}if(e.html().indexOf("{"+k)>-1){e.html(e.html().replace("{"+k+"}",g));
e.html(e.html().replace("{"+k+"u}",g+m))
}else{if(e.hasClass("theme-accent")){e.find("span").html(g+"<sup>"+m+"</sup>")
}else{e.prepend(g)
}}}}}$(this).append(e);
$(this).fadeIn();
$(document).foundation("equalizer","reflow")
}})
})
},convertDecimalsToCommas:function(a){if(typeof a==="number"){if(blackberrycom.location.language!=="en"&&blackberrycom.location.language!=="ar"){return a.toString().replace(".",",")
}}return a
},getProductById:function(b){for(var a=0;
a<blackberrycom.smartphones.productData.length;
a++){var c=blackberrycom.smartphones.productData[a];
if(b===c.productId||b.indexOf(c.productId)>-1){return c
}}}};
var blackberrycom=blackberrycom?blackberrycom:{};
blackberrycom.smartphones=blackberrycom.smartphones?blackberrycom.smartphones:{};
blackberrycom.smartphones.currentProducts=$("[data-products]").length>0?$("[data-products]").attr("data-products").split(","):"";
blackberrycom.smartphones.activeProduct=blackberrycom.smartphones.currentProducts[0];
blackberrycom.smartphones.activeColor="";
(function(a){a(document).ready(function(){if(blackberrycom.smartphones.currentProducts){blackberrycom.getProductData("id",function(){blackberrycom.smartphones.buyHero.init();
blackberrycom.smartphones.colorSwitcher.init();
blackberrycom.smartphones.modelSwitcher.init();
blackberrycom.smartphones.spec.init()
})
}else{blackberrycom.getProductData("country",function(){blackberrycom.smartphones.compare.init();
blackberrycom.smartphones.landing.init()
})
}blackberrycom.smartphones.pinnedDevice.init()
})
})(jQuery);
blackberrycom.getProductData=function(e,d,c){var a=typeof CQ!=="undefined"?CQ.WCM.isEditMode():false;
if(typeof blackberrycom.smartphones.productData!=="undefined"&&!c){d()
}else{var b={};
if(typeof e==="undefined"){e="country"
}if(e==="country"){b.values=blackberrycom.location.country
}else{if(e==="id"){b.values=blackberrycom.smartphones.currentProducts
}}b.language=blackberrycom.location.language;
b.country=blackberrycom.location.country;
$.ajax({url:"/bin/blackberry-com/product/"+e,data:b,traditional:true,dataType:"json",success:function(f){if(f){console.log("productData",f);
blackberrycom.smartphones.productData=f.data;
d();
console.log("Smartphones ready")
}}})
}};